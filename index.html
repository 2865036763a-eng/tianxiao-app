<!DOCTYPE html>
<html><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="å¤©ç¬‘ç§˜å¯†åŸºåœ°">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#ff6699">
    <link rel="manifest" href="data:application/json;base64,ewogICJuYW1lIjogIuWkqeesuOOBrue6geWvhuWfuuWcsyIsCiAgInNob3J0X25hbWUiOiAi5aSp56yY5Z+65ZywIiwKICAic3RhcnRfdXJsIjogIi4vIiwKICAiZGlzcGxheSI6ICJzdGFuZGFsb25lIiwKICAiYmFja2dyb3VuZF9jb2xvciI6ICIjZmZmZmZmIiwKICAidGhlbWVfY29sb3IiOiAiI2ZmNjY5OSIsCiAgImRlc2NyaXB0aW9uIjogIuWkqeesuOOBrue6geWvhuWfuuWcsyAtIOa4uOaIj+S4k+WxnuWIhuS6q+W5s+WPsCIsCiAgIm9yaWVudGF0aW9uIjogInBvcnRyYWl0IiwKICAiaWNvbnMiOiBbCiAgICB7CiAgICAgICJzcmMiOiAiZGF0YTppbWFnZS9zdmcreG1sO2Jhc2U2NCxQSE4yWnlCNGJXeHVjejBpYUhSMGNEb3ZMM2QzZHk1M015NXZjbWN2TWpBd01DOXpkbWNpSUhkcFpIUm9QU0l4TWpnaUlHaGxhV2RvZEQwaU1USTRJajQ4Y21WamRDQjNhV1IwYUQwaU1USTRJaUJvWldsbmFIUTlJakV5T0NJZ2NuZzlJakl3SWlCbWFXeHNQU0lqWm1ZMk5qazVJaTgrUEM5eVpXTjBQangwWlhoMElIZzlJall5SWlCNVBTSTJOQ0lnWm05dWRDMXphWHBsUFNJME1DSWdabWxzYkQwaUkyWm1abVptWmlJK/CfjIY8TDNSbGVIUStQQzl6ZG1jKyIsCiAgICAgICJzaXplcyI6ICIxMjh4MTI4IiwKICAgICAgInR5cGUiOiAiaW1hZ2Uvc3ZnK3htbCIsCiAgICAgICJwdXJwb3NlIjogImFueSBtYXNrYWJsZSIKICAgIH0KICBdCn0=">
    <link rel="apple-touch-icon" href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjgiIGhlaWdodD0iMTI4Ij48cmVjdCB3aWR0aD0iMTI4IiBoZWlnaHQ9IjEyOCIgcng9IjIwIiBmaWxsPSIjZmY2Njk5Ii8+PHRleHQgeD0iNjQiIHk9IjcwIiBmb250LXNpemU9IjUwIiBmaWxsPSIjZmZmZmZmIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBkb21pbmFudC1iYXNlbGluZT0ibWlkZGxlIj7wn4yGPC90ZXh0Pjwvc3ZnPg==">
    <title>å¤©ç¬‘ã®ç§˜å¯†åŸºåœ°</title>
    <style>
        :root { --primary: #ff6699; --bg: #f4f5f7; --card: #ffffff; --text: #222; --border: #e3e8ec; --video: #fb7299; --notice: #ff9800; }
        html, body { height: 100%; margin: 0; padding: 0; overscroll-behavior: none; overscroll-behavior-y: none; }
        body { background: var(--bg); color: var(--text); font-family: -apple-system, system-ui, sans-serif; display: flex; flex-direction: column; overflow: hidden; overscroll-behavior: none; }
        
        #gateKeeper { position: fixed; inset: 0; background: #fff; z-index: 2000; display: flex; align-items: center; justify-content: center; flex-direction: column; padding: 20px; text-align: center; }
        .gate-box { max-width: 400px; width: 100%; }
        .disclaimer { font-size: 12px; color: #999; background: #f9f9f9; padding: 15px; border-radius: 10px; margin-bottom: 20px; line-height: 1.6; border: 1px dashed #ddd; }
        .gate-input { width: 100%; padding: 12px; border-radius: 10px; border: 1px solid #ddd; margin-bottom: 15px; outline: none; text-align: center; font-size: 16px; box-sizing: border-box; }
        .gate-btn { width: 100%; padding: 12px; background: var(--primary); color: #fff; border: none; border-radius: 10px; font-weight: bold; cursor: pointer; touch-action: manipulation; }
        header { flex-shrink: 0; padding: 12px 15px; background: var(--card); border-bottom: 1px solid var(--border); z-index: 100; position: relative; }
        .header-top { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .site-title { font-size: 18px; font-weight: bold; color: var(--primary); flex: 1; text-align: center; margin-left: 30px; }
        .login-icon { font-size: 18px; cursor: pointer; color: #ccc; padding: 5px; touch-action: manipulation; }
        #search { width: 100%; padding: 10px; border-radius: 10px; border: 1px solid #ddd; background: #f9f9f9; outline: none; box-sizing: border-box; margin-bottom: 10px; touch-action: manipulation; }
        
        #nav { display: flex; overflow-x: auto; gap: 10px; padding-bottom: 5px; scrollbar-width: none; -webkit-overflow-scrolling: touch; }
        #nav::-webkit-scrollbar { display: none; }
        #nav li { list-style: none; padding: 7px 18px; background: #eee; border-radius: 20px; font-size: 13px; white-space: nowrap; cursor: pointer; color: #555; transition: 0.3s; touch-action: manipulation; }
        #nav li.active { background: var(--primary); color: #fff; font-weight: 500; }
        
        #nav li.notice-tab { background: #fff8e1; color: var(--notice); border: 1px solid var(--notice); }
        #nav li.notice-tab.active { background: var(--notice); color: #fff; }
        
        #nav li.favorite-tab { background: #ffe4f0; color: #ff1493; border: 1px solid #ff69b4; }
        #nav li.favorite-tab.active { background: #ff1493; color: #fff; }
        main { flex: 1; overflow-y: auto; padding: 12px; scroll-behavior: smooth; position: relative; -webkit-overflow-scrolling: touch; overscroll-behavior: contain; overscroll-behavior-y: contain; touch-action: pan-y; }
        .grid { display: flex; flex-direction: column; gap: 20px; max-width: 550px; margin: 0 auto; }
        
        .card { background: var(--card); border-radius: 12px; overflow: hidden; display: none; flex-direction: column; position: relative; border: 1px solid var(--border); box-shadow: 0 4px 15px rgba(0,0,0,0.05); }
        .card.active-render { display: flex; } 
        .card.is-pinned { border: 2px solid var(--notice); }
        .card.is-pinned::before { content: "ğŸ“Œ ç½®é¡¶"; position: absolute; top: 10px; right: 80px; background: var(--notice); color: #fff; font-size: 10px; padding: 2px 6px; border-radius: 4px; z-index: 10; font-weight: bold; }
        .slider-box { width: 100%; aspect-ratio: 16 / 9; background: #e0e0e0; position: relative; display: flex; align-items: center; justify-content: center; overflow: hidden; flex-shrink: 0; touch-action: pan-y pinch-zoom; }
        .slider-box img { width: 100%; height: 100%; display: none; object-fit: cover; background: #000; }
        .slider-box img.active { display: block; }
        
        .edit-img-btn { position: absolute; z-index: 15; background: var(--primary); color: #fff; padding: 8px 16px; border-radius: 20px; font-size: 13px; cursor: pointer; display: none; border: none; font-weight: bold; touch-action: manipulation; }
        .admin-mode .edit-img-btn { display: block; }
        .slide-btn { position: absolute; top: 50%; transform: translateY(-50%); background: rgba(0,0,0,0.4); color: #fff; border: none; width: 40px; height: 50px; cursor: pointer; font-size: 24px; z-index: 5; touch-action: manipulation; }
        .prev { left: 0; border-radius: 0 8px 8px 0; }
        .next { right: 0; border-radius: 8px 0 0 8px; }
        .img-index { position: absolute; bottom: 10px; right: 12px; background: rgba(0,0,0,0.6); color: #fff; padding: 3px 10px; border-radius: 12px; font-size: 11px; z-index: 4; }
        .info-box { padding: 15px; display: flex; flex-direction: column; background: #fff; }
        .g-name { font-size: 17px; font-weight: bold; line-height: 1.4; margin-bottom: 8px; color: #111; outline: none; }
        .g-tags { font-size: 12px; color: var(--primary); margin-bottom: 12px; outline: none; }
        .link-wrap { position: relative; background: #f8f9fb; border-radius: 8px; border: 1px solid #edf0f5; display: flex; flex-direction: column; }
        .link-text { font-size: 13px; padding: 12px; color: #333; word-break: break-all; line-height: 1.5; outline: none; display: -webkit-box; -webkit-box-orient: vertical; -webkit-line-clamp: 2; overflow: hidden; }
        .expanded .link-text { -webkit-line-clamp: initial; display: block; overflow-y: auto; max-height: 300px; color: #333; }
        .link-actions { display: flex; gap: 8px; padding: 8px 12px; border-top: 1px solid rgba(0,0,0,0.03); }
        .link-jump-btn { flex: 1; padding: 8px; background: #007bff; color: #fff; border: none; border-radius: 6px; font-size: 12px; font-weight: bold; cursor: pointer; transition: 0.2s; touch-action: manipulation; }
        .link-jump-btn:hover { background: #0056b3; }
        .link-jump-btn:active { transform: scale(0.95); }
        .admin-mode .link-jump-btn { display: none; }
        .expand-btn { text-align: right; padding: 5px 12px; font-size: 11px; color: var(--primary); cursor: pointer; border-top: 1px solid rgba(0,0,0,0.03); touch-action: manipulation; }
        .pagination { display: flex; flex-direction: column; align-items: center; gap: 12px; margin: 20px 0; padding: 0 10px 80px 10px; }
        .page-numbers { display: flex; align-items: center; justify-content: center; gap: 8px; flex-wrap: wrap; }
        .page-item { min-width: 38px; height: 38px; border: 1px solid var(--border); background: #fff; color: #666; display: flex; align-items: center; justify-content: center; border-radius: 10px; cursor: pointer; font-size: 14px; transition: 0.2s; touch-action: manipulation; }
        .page-item.active { background: var(--primary); color: #fff; border-color: var(--primary); font-weight: bold; box-shadow: 0 4px 10px rgba(255,102,153,0.3); }
        .page-dot { color: #ccc; }
        .page-jump-row { display: flex; align-items: center; gap: 10px; color: #999; font-size: 13px; flex-wrap: wrap; justify-content: center; }
        .page-jump { width: 90px; height: 36px; border: 1px solid var(--border); border-radius: 8px; padding: 0 10px; font-size: 13px; outline: none; text-align: center; touch-action: manipulation; }
        .side-nav-btn { position: fixed; bottom: 40px; width: 45px; height: 45px; background: rgba(255,255,255,0.9); color: var(--primary); border: 1px solid var(--border); border-radius: 50%; display: none; align-items: center; justify-content: center; font-size: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); cursor: pointer; z-index: 150; transition: 0.3s; touch-action: manipulation; }
        .side-nav-btn:active { transform: scale(0.9); background: var(--primary); color: #fff; }
        #prevPageBtn { left: 15px; }
        #nextPageBtn { right: 15px; }
        #rocket { position: fixed; right: 15px; bottom: -60px; width: 45px; height: 45px; background: var(--primary); color: #fff; border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 12px rgba(255,102,153,0.4); cursor: pointer; transition: 0.4s; z-index: 200; font-size: 22px; touch-action: manipulation; }
        #rocket.show { bottom: 100px; }
        #adminBar { margin-top: 10px; display: none; gap: 10px; padding-top: 12px; border-top: 1px solid #eee; }
        #adminBar button { flex: 1; cursor: pointer; border: none; border-radius: 8px; padding: 12px; background: var(--primary); color: #fff; font-weight: bold; touch-action: manipulation; }
        .btn-save { background: #28a745 !important; }
        .btn-exit { background: #666 !important; }
        .del-btn, .pin-btn, .fav-btn { position: absolute; top: 10px; width: 28px; height: 28px; border-radius: 50%; display: none; justify-content: center; align-items: center; z-index: 20; cursor: pointer; color: #fff; font-size: 14px; touch-action: manipulation; }
        .del-btn { right: 10px; background: rgba(255,0,0,0.8); }
        .pin-btn { right: 45px; background: rgba(255,152,0,0.8); }
        .fav-btn { right: 80px; background: rgba(255,20,147,0.9); }
        .fav-btn.favorited { background: rgba(255,20,147,1); font-size: 16px; }
        .admin-mode .del-btn, .admin-mode .pin-btn { display: flex; }
        .fav-btn { display: flex !important; }
        .modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.5); display: none; align-items: center; justify-content: center; z-index: 1000; }
        .modal-box { background: #fff; width: 85%; max-width: 350px; border-radius: 20px; padding: 25px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); }
        .modal-title { font-size: 16px; font-weight: bold; color: #333; margin-bottom: 15px; }
        .modal-input { width: 100%; padding: 12px 0; border: none; border-bottom: 1px solid #eee; font-size: 15px; outline: none; margin-bottom: 25px; }
        .modal-btns { display: flex; gap: 15px; }
        .modal-btn { flex: 1; padding: 12px; border: none; border-radius: 12px; font-weight: bold; cursor: pointer; touch-action: manipulation; }
        .btn-cancel { background: #f5f5f5; color: #666; }
        .btn-confirm { background: #eff4ff; color: #3b82f6; }
    </style>
<style>
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
    </style></head>
<body class="view-mode">
<div id="gateKeeper" style="display: flex;">
    <div class="gate-box">
        <h2 style="color:var(--primary)">å¤©ç¬‘ã®ç§˜å¯†åŸºåœ°</h2>
        <div class="disclaimer">
            <strong>ã€å…è´£å£°æ˜ã€‘</strong><br>
            æœ¬ç«™æ‰€æœ‰èµ„æºå‡æ”¶é›†è‡ªäº’è”ç½‘ï¼Œä»…ä¾›å­¦ä¹ å‚è€ƒä¸æŠ€æœ¯äº¤æµï¼Œä¸¥ç¦ç”¨äºä»»ä½•å•†ä¸šç”¨é€”ã€‚ä¸‹è½½åè¯·äº24å°æ—¶å†…åˆ é™¤ã€‚å› ç§è‡ªä¼ æ’­ã€å€’å–å¯¼è‡´çš„ä»»ä½•æ³•å¾‹çº çº·ä¸æœ¬ç«™æ— å…³ã€‚ç»§ç»­è®¿é—®å³ä»£è¡¨æ‚¨åŒæ„æœ¬åè®®ã€‚
        </div>
        <input type="password" id="accessPass" class="gate-input" placeholder="è¾“å…¥å¤©ç¬‘çš„è§£å‹æš—å·">
        <button class="gate-btn" onclick="verifyAccess()">è§£é”åŸºåœ°</button>
    </div>
</div>
<header>
    <div class="header-top">
        <div class="site-title">å¤©ç¬‘ã®ç§˜å¯†åŸºåœ°</div>
        <div id="entryBtn" class="login-icon" onclick="openLogin()" style="visibility: visible;">ğŸ”’</div>
    </div>
    <input type="text" id="search" placeholder="ğŸ” æœæœçœ‹..." oninput="refreshUI(1)">
    <div id="nav">
        <li class="notice-tab" onclick="filterTab('å…¬å‘Š',this)">ğŸ“¢ å…¬å‘Š</li>
        <li class="favorite-tab" onclick="filterTab('æ”¶è—',this)">ğŸ’– æˆ‘çš„æ”¶è—</li>
        <li class="active" onclick="filterTab('all',this)">ğŸŒŸ å…¨éƒ¨</li>
        <li onclick="filterTab('ACT',this)" class="">ACT</li>
        <li onclick="filterTab('SLG',this)" class="">SLG</li>
        <li onclick="filterTab('RPG',this)">RPG</li>
        <li onclick="filterTab('GAL',this)">GAL</li>
        <li onclick="filterTab('AZ',this)">AZ</li>
        <li onclick="filterTab('PC',this)">PC</li>
        <li onclick="filterTab('æœ¬å­',this)">ğŸ“š æœ¬å­</li>
        <li onclick="filterTab('å…¶ä»–è½¯ä»¶',this)">ğŸ› ï¸ å…¶ä»–è½¯ä»¶</li>
        <li onclick="filterTab('å……ç”µè§†é¢‘',this)" class="video-tab">âš¡ å……ç”µè§†é¢‘</li>
    </div>
    <div id="adminBar" style="display: none;">
        <button onclick="addCard()">â• æ–°å¢</button>
        <button class="btn-save" onclick="saveDataToWorker()">ğŸ’¾ ä¿å­˜åˆ°äº‘ç«¯</button>
        <button onclick="clearCacheAndReload()" style="background: #ff9800 !important;">ğŸ”„ æ¸…ç¼“å­˜</button>
        <button class="btn-exit" onclick="exitAdmin()">ğŸšª é€€å‡º</button>
    </div>
</header>
<main id="mainScroll" onscroll="handleScroll()">
    <div class="grid" id="box"></div>
    <div id="pagination" class="pagination"></div>
    <div id="rocket" onclick="goTop()" class="">ğŸš€</div>
    <div id="prevPageBtn" class="side-nav-btn" onclick="navPage(-1)">â€¹</div>
    <div id="nextPageBtn" class="side-nav-btn" onclick="navPage(1)">â€º</div>
</main>
<div id="loginModal" class="modal-overlay" style="display: none;">
    <div class="modal-box">
        <div class="modal-title">ğŸ”‘ éªŒè¯ç®¡ç†èº«ä»½ï¼š</div>
        <input type="password" id="passInput" class="modal-input" placeholder="å¤©ç¬‘çš„ç®¡ç†æš—å·">
        <div class="modal-btns">
            <button class="modal-btn btn-cancel" onclick="closeLogin()">å–æ¶ˆ</button>
            <button class="modal-btn btn-confirm" onclick="checkPass()">ç¡®å®š</button>
        </div>
    </div>
</div>
<script>
// ===== Cloudflare Worker æ ¸å¿ƒé…ç½®ï¼ˆå·²ä¿®æ­£åœ°å€ï¼‰=====
const API_BASE = 'https://5036763.workers.dev';
const ADMIN_PASS = "tianxiao";
// ================================================

// ===== ğŸ›¡ï¸ ç»ˆæé˜²ä¸‹æ‹‰åˆ·æ–° =====
(function() {
    let startY = 0;
    let startX = 0;
    document.addEventListener('touchstart', function(e) {
        startY = e.touches[0].pageY;
        startX = e.touches[0].pageX;
    }, { passive: true });
    document.addEventListener('touchmove', function(e) {
        const dy = e.touches[0].pageY - startY;
        const dx = e.touches[0].pageX - startX;
        const main = document.getElementById('mainScroll');
        if (Math.abs(dx) > Math.abs(dy)) return;
        const target = e.target.closest('#mainScroll') || e.target.closest('#nav');
        if (target === main) {
            const atTop = main.scrollTop <= 0;
            const atBottom = main.scrollTop + main.clientHeight >= main.scrollHeight - 1;
            if (atTop && dy > 0) {
                e.preventDefault();
                e.stopPropagation();
            } else if (atBottom && dy < 0) {
                e.preventDefault();
                e.stopPropagation();
            }
        } else {
            e.preventDefault();
            e.stopPropagation();
        }
    }, { passive: false });
    document.addEventListener('scroll', function() {
        if (window.scrollY !== 0) window.scrollTo(0, 0);
    }, { passive: true });
    const style = document.createElement('style');
    style.textContent = `
        html, body {
            overscroll-behavior: none !important;
            overscroll-behavior-y: none !important;
            overflow: hidden !important;
            position: fixed !important;
            width: 100% !important;
            height: 100% !important;
        }
        #mainScroll {
            overscroll-behavior: contain !important;
            overscroll-behavior-y: contain !important;
            -webkit-overflow-scrolling: touch !important;
        }
    `;
    document.head.appendChild(style);
})();
// ================================

const ACCESS_PASS = "114514"; 
const PAGE_SIZE = 10;
const FAV_KEY = "TX_FAVORITES";
const APP_VERSION = "3.0.0";
const VERSION_KEY = "TX_APP_VERSION";
let isEditMode = false;
let currentCat = "all";
let currentPage = 1;
let maxPageCount = 1;
let favorites = new Set();

// ===== ä»Cloudflare WorkeråŠ è½½æ•°æ®ï¼ˆå¸¦æœ¬åœ°å…œåº•ï¼‰=====
async function loadFromWorker() {
    try {
        const res = await fetch(`${API_BASE}/get`);
        if (!res.ok) throw new Error('åŠ è½½å¤±è´¥');
        const data = await res.json();
        if (data.html) {
            document.getElementById("box").innerHTML = data.html;
        }
        // åŠ è½½æœ¬åœ°æ”¶è—
        const savedFav = localStorage.getItem(FAV_KEY);
        if (savedFav) {
            try { favorites = new Set(JSON.parse(savedFav)); } catch(e) { favorites = new Set(); }
        }
        initCardFavorites();
        refreshUI();
        showToast("âœ… äº‘ç«¯æ•°æ®åŠ è½½æˆåŠŸ");
    } catch (err) {
        console.error('åŠ è½½äº‘ç«¯æ•°æ®å¤±è´¥:', err);
        showToast("âŒ äº‘ç«¯åŠ è½½å¤±è´¥ï¼Œä½¿ç”¨æœ¬åœ°ç¼“å­˜");
        // é™çº§åˆ°æœ¬åœ°ç¼“å­˜
        const localCache = localStorage.getItem("TX_CACHE");
        if (localCache) {
            document.getElementById("box").innerHTML = localCache;
            initCardFavorites();
            refreshUI();
        }
    }
}

// ===== ä¿å­˜æ•°æ®åˆ°Cloudflare Worker =====
async function saveDataToWorker() {
    if (!isEditMode) return;
    try {
        const html = document.getElementById("box").innerHTML;
        const res = await fetch(`${API_BASE}/set`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'password': ADMIN_PASS
            },
            body: JSON.stringify({ html: html })
        });
        if (res.ok) {
            showToast("âœ… æ•°æ®æˆåŠŸä¿å­˜åˆ°äº‘ç«¯");
            autoSave(); // åŒæ—¶ä¿å­˜æœ¬åœ°ç¼“å­˜
        } else {
            throw new Error('ä¿å­˜å¤±è´¥');
        }
    } catch (err) {
        console.error('ä¿å­˜äº‘ç«¯æ•°æ®å¤±è´¥:', err);
        showToast("âŒ äº‘ç«¯ä¿å­˜å¤±è´¥ï¼Œä»…ä¿å­˜æœ¬åœ°");
        autoSave();
    }
}

// æ£€æŸ¥ç‰ˆæœ¬æ›´æ–°
function checkForUpdates() {
    const savedVersion = localStorage.getItem(VERSION_KEY);
    if (!savedVersion) {
        localStorage.setItem(VERSION_KEY, APP_VERSION);
        console.log('âœ… é¦–æ¬¡å®‰è£…ï¼Œç‰ˆæœ¬:', APP_VERSION);
        return;
    }
    if (savedVersion !== APP_VERSION) {
        console.log('ğŸ”„ æ£€æµ‹åˆ°æ›´æ–°:', savedVersion, 'â†’', APP_VERSION);
        showUpdateNotification(savedVersion, APP_VERSION);
        localStorage.setItem(VERSION_KEY, APP_VERSION);
    }
}

// æ˜¾ç¤ºæ›´æ–°é€šçŸ¥
function showUpdateNotification(oldVer, newVer) {
    const notification = document.createElement('div');
    notification.style.cssText = `
        position: fixed;
        top: 20px;
        left: 50%;
        transform: translateX(-50%);
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 15px 25px;
        border-radius: 12px;
        box-shadow: 0 8px 20px rgba(0,0,0,0.3);
        z-index: 9999;
        font-size: 14px;
        font-weight: bold;
        animation: slideDown 0.5s ease;
    `;
    notification.innerHTML = `
        ğŸ‰ åº”ç”¨å·²æ›´æ–°ï¼
        <span style="opacity: 0.8; font-size: 12px; margin-left: 8px;">
        ${oldVer} â†’ ${newVer}
        </span>
    `;
    document.body.appendChild(notification);
    const style = document.createElement('style');
    style.textContent = `
        @keyframes slideDown {
            from { top: -100px; opacity: 0; }
            to { top: 20px; opacity: 1; }
        }
    `;
    document.head.appendChild(style);
    setTimeout(() => {
        notification.style.animation = 'slideDown 0.5s ease reverse';
        setTimeout(() => notification.remove(), 500);
    }, 5000);
}

// å¼ºåˆ¶åˆ·æ–°ç¼“å­˜
function clearCacheAndReload() {
    if ('serviceWorker' in navigator) {
        navigator.serviceWorker.getRegistrations().then(function(registrations) {
            for(let registration of registrations) {
                registration.unregister();
            }
        });
    }
    if ('caches' in window) {
        caches.keys().then(function(names) {
            for (let name of names) caches.delete(name);
        });
    }
    localStorage.removeItem("TX_CACHE");
    alert('âœ… ç¼“å­˜å·²æ¸…é™¤ï¼é¡µé¢å³å°†åˆ·æ–°');
    location.reload(true);
}

// æœ¬åœ°è‡ªåŠ¨ç¼“å­˜ï¼ˆé˜²ä¸¢å¤±ï¼‰
function autoSave() {
    const data = document.getElementById("box").innerHTML;
    localStorage.setItem("TX_CACHE", data);
}

// Toastæç¤º
let _toastTimer = null;
function showToast(msg, duration = 2500) {
    let toast = document.getElementById("_ghToast");
    if (!toast) {
        toast = document.createElement("div");
        toast.id = "_ghToast";
        toast.style.cssText = `
            position:fixed;top:20px;left:50%;transform:translateX(-50%);
            background:rgba(30,30,30,0.92);color:#fff;padding:10px 22px;
            border-radius:20px;font-size:13px;z-index:9999;
            box-shadow:0 4px 15px rgba(0,0,0,0.3);transition:opacity 0.3s;
            white-space:nowrap;pointer-events:none;
        `;
        document.body.appendChild(toast);
    }
    toast.textContent = msg;
    toast.style.opacity = "1";
    if (_toastTimer) clearTimeout(_toastTimer);
    if (duration > 0) {
        _toastTimer = setTimeout(() => { toast.style.opacity = "0"; }, duration);
    }
}

// åˆ·æ–°é¡µé¢UI
function refreshUI(targetPage) {
    if(targetPage) {
        currentPage = targetPage;
        goTop();
    }
    const searchVal = document.getElementById("search").value.toUpperCase();
    const box = document.getElementById("box");
    const allCards = Array.from(box.querySelectorAll(".card"));
    
    // è¿‡æ»¤é€»è¾‘
    let filtered = allCards.filter(c => {
        const txt = c.innerText.toUpperCase();
        const matchCat = (currentCat === "all" || txt.includes(currentCat));
        const matchSearch = txt.includes(searchVal);
        // æ”¶è—åˆ†åŒºå•ç‹¬è¿‡æ»¤
        if (currentCat === 'æ”¶è—') {
            const cardId = c.dataset.cardId;
            return cardId && favorites.has(cardId) && matchSearch;
        }
        return matchCat && matchSearch;
    });

    // æ’åºï¼šç½®é¡¶å¡ç‰‡ä¼˜å…ˆ
    filtered.sort((a, b) => {
        const aP = a.classList.contains("is-pinned") ? 1 : 0;
        const bP = b.classList.contains("is-pinned") ? 1 : 0;
        return bP - aP;
    });

    // åŠ¨æ€åˆ†é…orderï¼Œå®ç°æ’åº
    filtered.forEach((card, index) => {
        if (card.classList.contains("is-pinned")) {
            card.style.order = "-1000"; // ç½®é¡¶å¡ç‰‡æ’æœ€å‰
        } else {
            card.style.order = index; // æ™®é€šå¡ç‰‡æŒ‰è¿‡æ»¤é¡ºåºæ’
        }
    });
    
    // åˆ†é¡µå¤„ç†
    allCards.forEach(c => c.classList.remove("active-render"));
    const pagContainer = document.getElementById("pagination");
    maxPageCount = Math.ceil(filtered.length / PAGE_SIZE);
    
    if(currentPage > maxPageCount && maxPageCount > 0) currentPage = maxPageCount;
    const start = (currentPage - 1) * PAGE_SIZE;
    filtered.slice(start, start + PAGE_SIZE).forEach(c => c.classList.add("active-render"));
    
    // åˆ†é¡µæŒ‰é’®æ˜¾ç¤º
    document.getElementById("prevPageBtn").classList.toggle("show", currentPage > 1);
    document.getElementById("nextPageBtn").classList.toggle("show", currentPage < maxPageCount);
    pagContainer.innerHTML = "";
    
    if (maxPageCount > 1) {
        let numHtml = `<div class="page-numbers">`;
        let startPage = Math.max(1, currentPage - 2);
        let endPage = Math.min(maxPageCount, startPage + 4);
        if (endPage === maxPageCount) startPage = Math.max(1, maxPageCount - 4);
        
        if (startPage > 1) {
            numHtml += `<div class="page-item" onclick="refreshUI(1)">1</div>`;
            if (startPage > 2) numHtml += `<div class="page-dot">...</div>`;
        }
        for (let i = startPage; i <= endPage; i++) {
            numHtml += `<div class="page-item ${i === currentPage ? 'active' : ''}" onclick="refreshUI(${i})">${i}</div>`;
        }
        if (endPage < maxPageCount) {
            if (endPage < maxPageCount - 1) numHtml += `<div class="page-dot">...</div>`;
            numHtml += `<div class="page-item" onclick="refreshUI(${maxPageCount})">${maxPageCount}</div>`;
        }
        numHtml += `</div>`;
        
        let funcHtml = `
            <div class="page-jump-row">
                <span>è·³è‡³</span>
                <input type="number" class="page-jump" placeholder="é¡µç ..." onkeydown="if(event.keyCode==13) { let p=parseInt(this.value); if(p>0 && p<=${maxPageCount}) refreshUI(p); else alert('æ²¡æœ‰è¿™ä¸€é¡µï¼'); }">
                <span>/ å…± ${maxPageCount} é¡µ</span>
            </div>`;
        pagContainer.innerHTML = numHtml + funcHtml;
    }
    
    if(isEditMode) autoSave();
    addLinkJumpButtons();
}

// åˆ†é¡µå¯¼èˆª
function navPage(dir) {
    let target = currentPage + dir;
    if(target >= 1 && target <= maxPageCount) refreshUI(target);
}

// éªŒè¯è®¿é—®å¯†ç ï¼ˆä¿®å¤ç‰ˆï¼šå…ˆè§£é”å†åŠ è½½ï¼Œä¸ä¼šå¡ä½ï¼‰
function verifyAccess() {
    if(document.getElementById("accessPass").value === ACCESS_PASS) {
        document.getElementById("gateKeeper").style.display = "none";
        // å…ˆè§£é”ï¼Œå†å¼‚æ­¥åŠ è½½æ•°æ®ï¼Œé¿å…é¡µé¢å¡ä½
        setTimeout(() => {
            loadFromWorker();
        }, 100);
    } else {
        alert("ä½ å¥½åƒä¸æ˜¯è‡ªå·±äººï¼Œè‡ªç”±ä¹‹åœ°ä¸æ¬¢è¿ä½ â™‚");
    }
}

// åˆ†ç±»è¿‡æ»¤
function filterTab(cat, el) {
    document.querySelectorAll("#nav li").forEach(li => li.classList.remove("active"));
    el.classList.add("active");
    currentCat = cat;
    refreshUI(1); 
}

// æ»šåŠ¨ç›‘å¬
function handleScroll() {
    const main = document.getElementById("mainScroll");
    const rocket = document.getElementById("rocket");
    if (main.scrollTop > 300) rocket.classList.add("show");
    else rocket.classList.remove("show");
}

// è¿”å›é¡¶éƒ¨
function goTop() { document.getElementById("mainScroll").scrollTo({ top: 0, behavior: 'smooth' }); }

// æ‰“å¼€ç™»å½•å¼¹çª—
function openLogin() { if(!isEditMode) document.getElementById("loginModal").style.display = "flex"; }

// å…³é—­ç™»å½•å¼¹çª—
function closeLogin() { document.getElementById("loginModal").style.display = "none"; document.getElementById("passInput").value = ""; }

// éªŒè¯ç®¡ç†å‘˜å¯†ç 
function checkPass() {
    if(document.getElementById("passInput").value === ADMIN_PASS) { enterAdmin(); closeLogin(); }
    else { alert("ä½ è¿˜æƒ³å†’å……å¤©ç¬‘æˆ‘?å»é¹¿å§ä½ ï¼"); closeLogin(); }
}

// è¿›å…¥ç®¡ç†å‘˜æ¨¡å¼
function enterAdmin() {
    isEditMode = true; 
    document.body.classList.add("admin-mode");
    document.getElementById("adminBar").style.display = "flex";
    document.getElementById("entryBtn").style.visibility = "hidden";
    
    // ä¸ºæ‰€æœ‰å¡ç‰‡æ·»åŠ ç½®é¡¶/åˆ é™¤æŒ‰é’®
    document.querySelectorAll(".card").forEach(card => {
        if (!card.querySelector(".pin-btn")) {
            const pin = document.createElement("div");
            pin.className = "pin-btn";
            pin.innerHTML = "ğŸ“Œ";
            pin.onclick = function() { togglePin(this); };
            card.prepend(pin);
        }
        const delBtn = card.querySelector(".del-btn");
        if (delBtn) delBtn.onclick = function() { deleteCard(this); };
    });
    // å¼€å¯ç¼–è¾‘
    document.querySelectorAll(".g-name, .g-tags, .link-text").forEach(el => el.contentEditable = "true");
    refreshUI();
}

// é€€å‡ºç®¡ç†å‘˜æ¨¡å¼
function exitAdmin() {
    isEditMode = false; 
    document.body.classList.remove("admin-mode");
    document.getElementById("adminBar").style.display = "none";
    document.getElementById("entryBtn").style.visibility = "visible";
    // å…³é—­ç¼–è¾‘
    document.querySelectorAll(".g-name, .g-tags, .link-text").forEach(el => {
        el.contentEditable = "false";
        el.removeAttribute("contenteditable");
    });
    saveDataToWorker(); // é€€å‡ºæ—¶è‡ªåŠ¨ä¿å­˜åˆ°äº‘ç«¯
    refreshUI();
}

// åˆ‡æ¢ç½®é¡¶
function togglePin(btn) {
    const card = btn.parentElement;
    card.classList.toggle("is-pinned");
    refreshUI();
    autoSave();
}

// åˆ é™¤å¡ç‰‡
function deleteCard(btn) {
    const card = btn.parentElement;
    const cardName = card.querySelector('.g-name').innerText;
    if (confirm(`âš ï¸ ç¡®å®šè¦åˆ é™¤èµ„æºã€${cardName}ã€‘å—ï¼Ÿ`)) {
        card.remove();
        showToast("âœ… å·²æˆåŠŸåˆ é™¤ï¼");
        refreshUI();
        autoSave();
    }
}

// æ–°å¢å¡ç‰‡
function addCard() {
    const div = document.createElement("div");
    div.className = "card";
    let defaultTag = currentCat === 'all' ? 'ACT' : currentCat;
    
    div.innerHTML = `
        <div class="pin-btn" onclick="togglePin(this)">ğŸ“Œ</div>
        <div class="del-btn" onclick="deleteCard(this)">Ã—</div>
        <div class="slider-box">
            <button class="edit-img-btn" onclick="editCurrentImg(this)">ğŸ”— æ›´æ¢å›¾ç‰‡</button>
            <button class="slide-btn prev" onclick="changeSlide(this, -1)">â€¹</button>
            <img class="active" loading="lazy" src="https://via.placeholder.com">
            <img loading="lazy" src="https://via.placeholder.com">
            <img loading="lazy" src="https://via.placeholder.com">
            <button class="slide-btn next" onclick="changeSlide(this, 1)">â€º</button>
            <div class="img-index">1 / 3</div>
            <div class="fav-btn" onclick="toggleFavorite(this)">ğŸ¤</div>
        </div>
        <div class="info-box">
            <div class="g-name">æ ‡é¢˜...</div>
            <div class="g-tags">æ ‡ç­¾: ${defaultTag}</div>
            <div class="link-wrap">
                <div class="link-text">ğŸ”— é“¾æ¥åŠç®€ä»‹...</div>
                <div class="expand-btn" onclick="toggleExpand(this)">å±•å¼€ â–¾</div>
            </div>
        </div>
    `;
    // æ’å…¥æ–°å¡ç‰‡
    document.getElementById("box").prepend(div);
    // åˆ†é…å”¯ä¸€ID
    div.dataset.cardId = 'card_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
    // ç®¡ç†å‘˜æ¨¡å¼ä¸‹å¼€å¯ç¼–è¾‘
    if (isEditMode) {
        div.querySelectorAll(".g-name, .g-tags, .link-text").forEach(el => el.contentEditable = "true");
    }
    document.getElementById("search").value = ""; 
    refreshUI(1);
}

// åˆ‡æ¢å›¾ç‰‡è½®æ’­
function changeSlide(btn, dir) {
    const box = btn.parentElement;
    const imgs = box.querySelectorAll('img');
    const indexTag = box.querySelector('.img-index');
    let idx = Array.from(imgs).findIndex(img => img.classList.contains('active'));
    imgs[idx].classList.remove('active');
    idx = (idx + dir + imgs.length) % imgs.length;
    imgs[idx].classList.add('active');
    indexTag.innerText = `${idx + 1} / ${imgs.length}`;
}

// ç¼–è¾‘å½“å‰å›¾ç‰‡
function editCurrentImg(btn) {
    const activeImg = btn.parentElement.querySelector('img.active');
    const url = prompt("ğŸ–¼ï¸ è¾“å…¥å›¾ç‰‡URL:", activeImg.src);
    if(url && url.startsWith('http')) {
        activeImg.src = url;
        autoSave();
    }
}

// å±•å¼€/æ”¶èµ·é“¾æ¥
function toggleExpand(btn) {
    const wrap = btn.parentElement;
    wrap.classList.toggle('expanded');
    btn.innerText = wrap.classList.contains('expanded') ? "æ”¶èµ· â–´" : "å±•å¼€ â–¾";
}

// åˆå§‹åŒ–æ”¶è—æŒ‰é’®
function initCardFavorites() {
    const allCards = document.querySelectorAll('.card');
    allCards.forEach((card, index) => {
        // åˆ†é…å”¯ä¸€ID
        if (!card.dataset.cardId) {
            card.dataset.cardId = 'card_' + Date.now() + '_' + index;
        }
        // æ·»åŠ æ”¶è—æŒ‰é’®
        if (!card.querySelector('.fav-btn')) {
            const favBtn = document.createElement('div');
            favBtn.className = 'fav-btn';
            const cardId = card.dataset.cardId;
            favBtn.innerHTML = favorites.has(cardId) ? 'ğŸ’–' : 'ğŸ¤';
            if (favorites.has(cardId)) favBtn.classList.add('favorited');
            favBtn.onclick = function() { toggleFavorite(this); };
            // æ’å…¥åˆ°è½®æ’­æ¡†
            const sliderBox = card.querySelector('.slider-box');
            if (sliderBox) {
                sliderBox.appendChild(favBtn);
            } else {
                card.prepend(favBtn);
            }
        }
    });
}

// åˆ‡æ¢æ”¶è—
function toggleFavorite(btn) {
    const card = btn.closest('.card');
    const cardId = card.dataset.cardId;
    if (!cardId) return;
    // åˆ‡æ¢æ”¶è—çŠ¶æ€
    if (favorites.has(cardId)) {
        favorites.delete(cardId);
        btn.innerHTML = 'ğŸ¤';
        btn.classList.remove('favorited');
    } else {
        favorites.add(cardId);
        btn.innerHTML = 'ğŸ’–';
        btn.classList.add('favorited');
    }
    // ä¿å­˜æ”¶è—åˆ°æœ¬åœ°
    saveFavorites();
    // æ”¶è—åˆ†åŒºå®æ—¶åˆ·æ–°
    if (currentCat === 'æ”¶è—') {
        refreshUI();
    }
}

// ä¿å­˜æ”¶è—æ•°æ®
function saveFavorites() {
    localStorage.setItem(FAV_KEY, JSON.stringify([...favorites]));
}

// ä¸ºé“¾æ¥æ·»åŠ è·³è½¬æŒ‰é’®
function addLinkJumpButtons() {
    document.querySelectorAll('.link-wrap').forEach(wrap => {
        if (wrap.querySelector('.link-actions')) return;
        const linkText = wrap.querySelector('.link-text');
        const expandBtn = wrap.querySelector('.expand-btn');
        if (!linkText || !expandBtn) return;
        // æå–é“¾æ¥
        const text = linkText.innerText || linkText.textContent;
        const urls = extractUrls(text);
        if (urls.length === 0) return;
        // åˆ›å»ºæŒ‰é’®å®¹å™¨
        const actionsDiv = document.createElement('div');
        actionsDiv.className = 'link-actions';
        // å•ä¸ªé“¾æ¥/å¤šä¸ªé“¾æ¥å¤„ç†
        if (urls.length === 1) {
            actionsDiv.innerHTML = `<button class="link-jump-btn" onclick="window.open('${urls[0]}', '_blank')">ğŸ”— æ‰“å¼€é“¾æ¥</button>`;
        } else {
            const urlsJson = JSON.stringify(urls).replace(/'/g, "\\'");
            actionsDiv.innerHTML = `<button class="link-jump-btn" onclick='showLinkSelector(${urlsJson})'>ğŸ”— é€‰æ‹©é“¾æ¥ (${urls.length}ä¸ª)</button>`;
        }
        // æ’å…¥æŒ‰é’®
        wrap.insertBefore(actionsDiv, expandBtn);
    });
}

// æå–æ–‡æœ¬ä¸­çš„URL
function extractUrls(text) {
    const urlPattern = /(https?:\/\/[^\s<>"]+)/g;
    const matches = text.match(urlPattern);
    if (!matches) return [];
    // æ¸…ç†URLæœ«å°¾æ ‡ç‚¹
    return matches.map(url => {
        return url.replace(/[,ï¼Œã€‚.;ï¼›!ï¼?ï¼Ÿ\)ï¼‰\]ã€‘}>ã€‹\'"]+$/, '');
    });
}

// æ˜¾ç¤ºå¤šé“¾æ¥é€‰æ‹©å™¨
function showLinkSelector(urls) {
    const modal = document.createElement('div');
    modal.className = 'modal-overlay';
    modal.style.display = 'flex';
    // ç”Ÿæˆé“¾æ¥æŒ‰é’®
    let linksHtml = urls.map((url, idx) => {
        const shortUrl = url.length > 60 ? url.substring(0, 60) + '...' : url;
        return `<div style="margin: 8px 0;">
            <button class="modal-btn btn-confirm" onclick="window.open('${url}', '_blank'); this.closest('.modal-overlay').remove();" style="width: 100%; text-align: left; padding: 12px; word-break: break-all;">
                ${idx + 1}. ${shortUrl}
            </button>
        </div>`;
    }).join('');
    // å¼¹çª—å†…å®¹
    modal.innerHTML = `
        <div class="modal-box" style="max-width: 450px;">
            <div class="modal-title">ğŸ”— é€‰æ‹©è¦æ‰“å¼€çš„é“¾æ¥ (å…±${urls.length}ä¸ª)</div>
            <div style="max-height: 400px; overflow-y: auto;">
                ${linksHtml}
            </div>
            <div style="margin-top: 15px;">
                <button class="modal-btn btn-cancel" onclick="this.closest('.modal-overlay').remove()" style="width: 100%;">å–æ¶ˆ</button>
            </div>
        </div>
    `;
    document.body.appendChild(modal);
    // ç‚¹å‡»èƒŒæ™¯å…³é—­
    modal.addEventListener('click', function(e) {
        if (e.target === modal) {
            modal.remove();
        }
    });
}

// é¡µé¢åŠ è½½å®Œæˆ
window.onload = () => { 
    // æ£€æŸ¥ç‰ˆæœ¬æ›´æ–°
    checkForUpdates();
    // éç®¡ç†å‘˜æ¨¡å¼ä¸‹é”å®šç¼–è¾‘
    if (!isEditMode) {
        document.querySelectorAll(".g-name, .g-tags, .link-text").forEach(el => {
            el.contentEditable = "false";
            el.removeAttribute("contenteditable");
        });
    }
    // æ³¨å†ŒService Workerï¼ˆPWAï¼‰
    if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register(createServiceWorkerBlob()).then(function(registration) {
            console.log('âœ… PWAå·²æ¿€æ´»ï¼å¯ä»¥æ·»åŠ åˆ°ä¸»å±å¹•äº†');
            // ç›‘å¬æ›´æ–°
            registration.addEventListener('updatefound', () => {
                const newWorker = registration.installing;
                newWorker.addEventListener('statechange', () => {
                    if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                        if (confirm('ğŸ‰ å‘ç°æ–°ç‰ˆæœ¬ï¼æ˜¯å¦ç«‹å³æ›´æ–°ï¼Ÿ')) {
                            newWorker.postMessage({ action: 'skipWaiting' });
                            window.location.reload();
                        }
                    }
                });
            });
        }).catch(function(err) {
            console.log('Service Workeræ³¨å†Œå¤±è´¥:', err);
        });
    }
    // ç›‘å¬å®‰è£…PWAæç¤º
    let deferredPrompt;
    window.addEventListener('beforeinstallprompt', (e) => {
        e.preventDefault();
        deferredPrompt = e;
        showInstallButton();
    });
};

// åˆ›å»ºå†…è”Service Worker
function createServiceWorkerBlob() {
    const swCode = `
        const CACHE_NAME = 'tianxiao-cache-v3';
        const urlsToCache = ['/'];
        self.addEventListener('install', event => {
            event.waitUntil(
                caches.open(CACHE_NAME).then(cache => cache.addAll(urlsToCache))
            );
        });
        self.addEventListener('fetch', event => {
            event.respondWith(
                caches.match(event.request).then(response => {
                    return response || fetch(event.request);
                })
            );
        });
    `;
    const blob = new Blob([swCode], { type: 'application/javascript' });
    return URL.createObjectURL(blob);
}

// æ˜¾ç¤ºPWAå®‰è£…æŒ‰é’®
function showInstallButton() {
    if (window.matchMedia('(display-mode: standalone)').matches) return;
    const installBtn = document.createElement('div');
    installBtn.innerHTML = 'ğŸ“±';
    installBtn.style.cssText = `
        position: fixed;
        left: 15px;
        bottom: 100px;
        width: 45px;
        height: 45px;
        background: #4CAF50;
        color: #fff;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 22px;
        box-shadow: 0 4px 12px rgba(76,175,80,0.4);
        cursor: pointer;
        z-index: 200;
        animation: pulse 2s infinite;
    `;
    installBtn.title = 'æ·»åŠ åˆ°ä¸»å±å¹•';
    installBtn.onclick = installApp;
    document.body.appendChild(installBtn);
    const style = document.createElement('style');
    style.textContent = `
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
    `;
    document.head.appendChild(style);
}

// å®‰è£…PWA
function installApp() {
    if (!window.deferredPrompt) {
        alert('ğŸ“± è¯·ç‚¹å‡»æµè§ˆå™¨èœå•ä¸­çš„"æ·»åŠ åˆ°ä¸»å±å¹•"é€‰é¡¹ï¼');
        return;
    }
    window.deferredPrompt.prompt();
    window.deferredPrompt.userChoice.then((choiceResult) => {
        if (choiceResult.outcome === 'accepted') {
            console.log('ç”¨æˆ·æ¥å—äº†å®‰è£…');
        }
        window.deferredPrompt = null;
    });
}

// å®šæ—¶è‡ªåŠ¨ä¿å­˜æœ¬åœ°ç¼“å­˜
setInterval(() => { if(isEditMode) autoSave(); }, 5000);
</script>
</body>
</html>
